---
title: "2021.01.27 TIL"
excerpt: "월간 프로젝트 D-2. 차선인식 모의 자율주행"
toc: true
toc_sticky: true

categories:
    - TIL 
tags:
    - TIL
    - 자율주행 스쿨
    - ROS
    - OpenCV
    - Project

last_modified_at: 2021.01.27-13:27:26  
---
 
# 2021-01-27 TIL📓
## 오늘 할 일
- [x] 월간 프로젝트 대비 실습 겸 오프라인 강의

## 월간 자율주행 프로젝트 D-2
### 수행 내용 
- 카메라 기반의 차선 인식 자이카(xycar) 자율주행
- 명도차 or 허프 변환 or 슬라이딩 윈도우 세 방식 중에 허프 변환을 이용
- 허프 변환을 사용한 이유?
    - 명도차는 주변 환경(조도)에 영향을 너무 많이 받아서 오인식을 하는 경우가 많음
    - 슬라이딩 윈도우는 아직 코드를 다 분석하지 못 함, 내꺼로 만들지 못 함
    - 허프 변환은 적절한 임계값 조절을 통해 차선 인식률을 셋 중에 가장 좋음
- 속도 조절은 어떻게?
    - 아직은 직선 주행이나 곡선 주행 모두 일정한 속도로 주행하도록 구현됨
    - 직선과 곡선을 나눠서 속도 조절하도록 수정 예정
- 조향각 설정은 어떻게?
    - 허프 변환을 통해 추출한 차선의 좌표값으로 기울기를 구하여 각도 계산
    - 카메라를 통해 보이는 화면은 '\|' 이러한 일자 직선이 \'/' 사선으로 보이기 때문에 보정이 필요함
    - 직선 주행할 때의 차선 기울기 정보를 받아서, 이것의 평균값을 구해 직선일 때의 각도를 정의함

### 결과
- 참혹함...
- 암담함

### 문제점
1. 조향각 설정을 잘 못 함
    - 차선의 기울기를 구한 후 이것을 바로 조향각에 적용을 해버림...(멍청한 놈😩)
2. 차선 중앙 유지를 못 함
    - 먼저 코드가 제대로 구현이 안되어 있음
    - 곡선 주행만 신경을 쓰다 보니 직선 주행을 제대로 고려 못 함
3. NonType 에러
    - 차선의 오인식을 하거나 아예 인식을 못 했을 때에 대비한 예외 처리를 제대로 하지 못 함

### 개선 방향
1. 90도에서 차선의 기울기를 빼줘야지 이것이 조향각이 됨\
    ![steer_angle](/assets/images/lecture/week09_imgs/steer_angle.jpeg)
    - RVIZ 로 시뮬레이션을 실행한 결과, 인식된 차선에 맞게 조향이 이루어짐\
    [![rviz 시뮬레이션](https://img.youtube.com/vi/ICb-n6X4lPE/0.jpg)](https://youtu.be/ICb-n6X4lPE)
2. 명도차 기반의 주행에서 사용했던 픽셀 차이 계산으로 조향을 조절했던 것을 바탕으로 주행 할 수 있도록 수정 예정
3. 이미지 처리를 더 강화할 필요가 있음
    - 인식된 차선에 대한 필터링(?)
    - 확실한 한 선에 대한 정보만 받아서 처리(?)
    - 고민해보자


## 잡담...
속도가 느려도 제발 한 번만 돌자는 목표로 임했지만, 뜻대로 잘 되지 않았다.
몇 가지 확실한 문제점들이 보이긴 하지만, 이걸 해결한다고 잘 될까?
찝찝한 기분이 든다.
내일은 제발 주행에 성공하길🙏


## 장기계획
- 코딩테스트 대비 **코드 스니펫** 만들기
- vim과 친해지기 위해 **plugin**을 적극 활용할 수 있도록 공부하고, 나만의 **.vimrc** 만들기
    - 일단 제일 먼저 autopep8 플러그인 설치
    - pep8에 위배되는 문법을 내 코드에서 찾아서 하이라이팅 해주는 플러그인이 있다고 하는데 찾아서 설치하자!
- 💫 밀린 강의노트 정리
